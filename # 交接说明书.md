# äº¤æ¥è¯´æ˜ä¹¦

## ä¸€ã€é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªåŸºäº **Apache Doris 4.0** çš„æ•°æ®ä¸­å°é¡¹ç›®ï¼Œé‡‡ç”¨ **Agent-to-Agent (A2A)** æ¶æ„ï¼Œå…è®¸å¤–éƒ¨å‰ç«¯ Agent é€šè¿‡ç®€å•çš„ HTTP API ä¸ Doris çš„ AI åŠŸèƒ½äº¤äº’ã€‚

**æ ¸å¿ƒç›®æ ‡**: æ„å»ºä¸€ä¸ªæ™ºèƒ½çš„å¤š Agent ç³»ç»Ÿï¼Œèƒ½å¤Ÿç†è§£è‡ªç„¶è¯­è¨€æŸ¥è¯¢å¹¶ç”Ÿæˆç²¾ç¡®çš„ SQLï¼Œç‰¹åˆ«æ˜¯è§£å†³æ¨¡ç³ŠåŒ¹é…ã€å¤šç»´åº¦æŸ¥è¯¢å’Œè·¨è¡¨æŸ¥è¯¢çš„é—®é¢˜ã€‚

---

## äºŒã€æŠ€æœ¯æ ˆ

### åç«¯
- **Python 3.11**
- **FastAPI 0.115.0** - API æ¡†æ¶
- **Apache Doris 4.0.0** - MPP å®æ—¶åˆ†ææ•°æ®åº“
- **Vanna.AI 0.7.9** - RAG-based Text-to-SQL æ¡†æ¶
- **PyMySQL** - æ•°æ®åº“è¿æ¥
- **Pandas** - æ•°æ®å¤„ç†

### å‰ç«¯
- **Vue 3.5.22 + TypeScript**
- **Vite 7.1.7** - æ„å»ºå·¥å…·
- **Ant Design Vue 4.2.6** - UI ç»„ä»¶åº“

### éƒ¨ç½²
- **Docker Compose** - å®¹å™¨ç¼–æ’
- **4 ä¸ªæœåŠ¡**: Frontend (5173), Backend (8018), Doris FE (18030/19030), Doris BE (18040/19050/19060)
- **ç½‘ç»œ**: `192.168.88.0/24`

### AI æœåŠ¡
- **DeepSeek API** - LLM æä¾›å•†
- **API Key**: `sk-748638f482f74b7392a6dafd89bdd307` (å¯èƒ½å·²å¤±æ•ˆï¼Œéœ€è¦æ›´æ–°)
- **Base URL**: `https://api.deepseek.com`
- **Model**: `deepseek-chat`

---

## ä¸‰ã€ç°æœ‰ç³»ç»Ÿæ¶æ„

### 3.1 ç›®å½•ç»“æ„

```
doris-sga/
â”œâ”€â”€ doris-api/              # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ main.py            # FastAPI ä¸»ç¨‹åº
â”‚   â”œâ”€â”€ vanna_doris.py     # Vanna.AI é›†æˆ (å·²ä¼˜åŒ–)
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â””â”€â”€ requirements.txt
â”œâ”€â”€ doris-frontend/         # å‰ç«¯æœåŠ¡
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ views/
â”‚   â”‚   â”‚   â”œâ”€â”€ ExcelUpload.vue    # Excel ä¸Šä¼ é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ AIConfig.vue       # AI é…ç½®é¡µé¢
â”‚   â”‚   â”‚   â””â”€â”€ AIQuery.vue        # AI é—®ç­”é¡µé¢
â”‚   â”‚   â””â”€â”€ router/
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ docker-compose.yml      # å®¹å™¨ç¼–æ’
â”œâ”€â”€ API_EXAMPLES.md        # API æ–‡æ¡£
â””â”€â”€ examples/
    â””â”€â”€ python_agent_example.py  # Python å®¢æˆ·ç«¯ç¤ºä¾‹
```

### 3.2 æ•°æ®åº“æƒ…å†µ

**æ•°æ®åº“å**: `doris_db`

**ä¸»è¦è¡¨**: `institutions` (æœºæ„è¡¨)

**è¡¨ç»“æ„** (50+ ç»´åº¦):
- **åœ°ç†ç»´åº¦**: æ‰€åœ¨çœ, æ‰€åœ¨å¸‚
- **æ—¶é—´ç»´åº¦**: æˆç«‹æ—¥æœŸ, æˆç«‹å¹´, æˆç«‹å¹´åŒºé—´
- **ç»„ç»‡ç»´åº¦**: ç»„ç»‡åç§°, ç»„ç»‡ç±»å‹1, ç»„ç»‡ç±»å‹2, æ¢çº½ç»„ç»‡
- **è´¢åŠ¡ç»´åº¦**: 2021æ€»æ”¶å…¥, 2021æ€»æ”¶å…¥åŒºé—´, æ”¶å…¥æ¥æº1/2/3, 2021æèµ æ”¶å…¥, 2021æä¾›æœåŠ¡æ”¶å…¥, 2021æ”¿åºœè¡¥åŠ©æ”¶å…¥, 2021æ€»æ”¯å‡º, 2021ä¸šåŠ¡æ´»åŠ¨æˆæœ¬
- **è®®é¢˜ç»´åº¦**: è®®é¢˜/æ‰‹æ³•, é¦–é€‰é¡¹1/2, æ¬¡é€‰è®®é¢˜, æ¬¡é€‰è®®é¢˜2, æ¬¡é€‰ç”Ÿæ€ä¿æŠ¤ä¸ä¿®å¤, æ¬¡é€‰æ±¡æŸ“é˜²æ²», æ¬¡é€‰æ°”å€™å˜åŒ–
- **æ‰‹æ³•ç»´åº¦**: æ¬¡é€‰æ‰‹æ³•, æ¬¡é€‰æ‰‹æ³•2, æ¬¡é€‰å…¬ä¼—å®£ä¼ å€¡å¯¼, æ¬¡é€‰ç”Ÿæ€ç¯å¢ƒæ³•åˆ¶, æ¬¡é€‰ç»¿è‰²ä½ç¢³ä¼ä¸šæ¨åŠ¨, æ¬¡é€‰å›½é™…åˆä½œ, æ¬¡é€‰è¡Œä¸šå»ºè®¾ä¸å‘å±•, æ¬¡é€‰å…¶ä»–æ‰‹æ³•
- **äººå‘˜ç»´åº¦**: ä¸“èŒäººå‘˜, ä¸“èŒäººå‘˜åŒºé—´, å…¼èŒäººå‘˜, å¿—æ„¿è€…
- **è”ç³»ç»´åº¦**: è”ç³»äºº, è”ç³»äººç”µè¯, è”ç³»äººé‚®ç®±
- **å…¶ä»–**: ç»Ÿä¸€ç¤¾ä¼šä¿¡ç”¨ä»£ç , æ…ˆå–„ç»„ç»‡, å¹´æŠ¥, ä¼ æ’­ä¿¡æ¯, æ˜¯å¦å‚åŠ 2023

**æ•°æ®ç‰¹ç‚¹**:
- åŸå¸‚å­—æ®µå­˜å‚¨çš„æ˜¯ "å¹¿å·å¸‚" è€Œä¸æ˜¯ "å¹¿å·"
- éœ€è¦æ™ºèƒ½æ¨¡ç³ŠåŒ¹é…
- å¤šç»´åº¦ç»„åˆæŸ¥è¯¢å¤æ‚

---

## å››ã€API æ¥å£æƒ…å†µ

**Base URL**: `http://localhost:8018`

### 4.1 æ ¸å¿ƒæ¥å£

#### 1. Excel ä¸Šä¼ 
```
POST /api/upload/excel
Content-Type: multipart/form-data

å‚æ•°:
- file: Excel æ–‡ä»¶
- table_name: è¡¨å

è¿”å›:
{
  "success": true,
  "message": "æˆåŠŸå¯¼å…¥ 17 æ¡æ•°æ®åˆ°è¡¨ institutions",
  "rows_imported": 17
}
```

#### 2. AI èµ„æºé…ç½®
```
POST /api/ai/resource
Content-Type: application/json

{
  "resource_name": "deepseek_resource",
  "api_key": "sk-xxx",
  "model": "deepseek-chat",
  "base_url": "https://api.deepseek.com"
}
```

#### 3. è‡ªç„¶è¯­è¨€æŸ¥è¯¢ (æ ¸å¿ƒ)
```
POST /api/query/natural
Content-Type: application/json

{
  "query": "2022å¹´å¹¿å·åœ°åŒºæ”¶å…¥è¶…5ä¸‡å…ƒçš„æœºæ„æœ‰å¤šå°‘ä¸ª?",
  "api_key": "sk-xxx"  // å¯é€‰
}

è¿”å›:
{
  "success": true,
  "sql": "SELECT COUNT(*) FROM institutions WHERE ...",
  "data": [...],
  "columns": [...]
}
```

#### 4. SQL æŸ¥è¯¢
```
POST /api/query/sql
Content-Type: application/json

{
  "sql": "SELECT * FROM institutions LIMIT 10"
}
```

#### 5. è®­ç»ƒ Vanna.AI
```
POST /api/train
Content-Type: application/json

{
  "question": "æ¥è‡ªå¹¿å·çš„æœºæ„æœ‰å¤šå°‘ä¸ª?",
  "sql": "SELECT COUNT(*) FROM institutions WHERE city LIKE '%å¹¿å·%'"
}
```

---

## äº”ã€å·²å®Œæˆçš„å·¥ä½œ

### 5.1 åŸºç¡€åŠŸèƒ½ âœ…
1. âœ… Docker å®Œæ•´éƒ¨ç½² (Frontend + Backend + Doris FE + Doris BE)
2. âœ… Excel ä¸Šä¼ æ¥å£ (æ”¯æŒè‡ªåŠ¨å»ºè¡¨ã€æ•°æ®å¯¼å…¥)
3. âœ… AI èµ„æºé…ç½®é¡µé¢
4. âœ… è‡ªç„¶è¯­è¨€æŸ¥è¯¢æ¥å£
5. âœ… Vanna.AI é›†æˆ (RAG-based Text-to-SQL)
6. âœ… å‰ç«¯ä¸‰ä¸ªé¡µé¢ (Excel ä¸Šä¼ ã€AI é…ç½®ã€AI é—®ç­”)
7. âœ… API æ–‡æ¡£å’Œç¤ºä¾‹ä»£ç 

### 5.2 æ™ºèƒ½ä¼˜åŒ– âœ…
1. âœ… **æ™ºèƒ½ Prompt å¢å¼º** - åœ¨ `doris-api/vanna_doris.py` ä¸­å®ç°
   - è‡ªåŠ¨è·å–è¡¨çš„æ ·æœ¬æ•°æ®
   - æå–é‡è¦åˆ—çš„ DISTINCT å€¼
   - åœ¨ Prompt ä¸­æä¾›çœŸå®æ•°æ®ä¸Šä¸‹æ–‡
   - æ˜ç¡®çš„æ¨¡ç³ŠåŒ¹é…è§„åˆ™

2. âœ… **å…³é”®æ–¹æ³•**:
   - `get_column_sample_values()` - è·å–åˆ—çš„æ ·æœ¬å€¼
   - `is_important_column()` - åˆ¤æ–­åˆ—æ˜¯å¦é‡è¦
   - `get_sql_prompt()` - å¢å¼ºçš„ Prompt ç”Ÿæˆ

### 5.3 å·²çŸ¥é—®é¢˜ âš ï¸
1. âš ï¸ **DeepSeek API Key å¯èƒ½å¤±æ•ˆ** - è¿”å› 401 é”™è¯¯
2. âš ï¸ **æ¨¡ç³ŠåŒ¹é…ä¸å¤Ÿæ™ºèƒ½** - åªè§£å†³äº†åŸå¸‚ç»´åº¦ï¼Œå…¶ä»– 50+ ç»´åº¦æœªè¦†ç›–
3. âš ï¸ **æ— è·¨è¡¨æŸ¥è¯¢èƒ½åŠ›** - ç›®å‰åªæ”¯æŒå•è¡¨æŸ¥è¯¢

---

## å…­ã€æ¥ä¸‹æ¥è¦åšçš„äº‹æƒ… (æ ¸å¿ƒä»»åŠ¡)

### ğŸ¯ **ç›®æ ‡: æ„å»ºå¤š Agent æ¶æ„ï¼Œå®ç°æ™ºèƒ½çš„å¤šç»´åº¦ã€è·¨è¡¨æŸ¥è¯¢**

### 6.1 æ¶æ„è®¾è®¡ (æ¨èä½¿ç”¨ LangGraph)

**ç”¨æˆ·å·²æ˜ç¡®è¦æ±‚çš„æ¶æ„**:

```
ç”¨æˆ·ä¸Šä¼  Excel 
    â†“
æå–è¡¨å¤´ + å‰5è¡Œæ•°æ®
    â†“
Meta-Agent (å…ƒæ™ºèƒ½ä½“)
    â†“
ç”Ÿæˆ "è¡¨ç®¡ç†å‘˜ Agent" (Table Admin Agent)
    â†“
å­˜å‚¨è¡¨ç®¡ç†å‘˜é…ç½® (åŒ…å« CoT)
    â†“
ç”¨æˆ·æé—®
    â†“
Planner Agent (è°ƒåº¦å‘˜)
    â†“
è¯†åˆ«æ¶‰åŠå“ªäº›è¡¨
    â†“
åˆ†é…ç»™å¯¹åº”çš„ Table Admin Agents
    â†“
å„è¡¨ç®¡ç†å‘˜ç‹¬ç«‹æŸ¥è¯¢ (ä½¿ç”¨ CoT æ‹†è§£é—®é¢˜)
    â†“
Coordinator Agent (æ±‡æ€»å‘˜)
    â†“
æ±‡æ€»ç»“æœå¹¶è¾“å‡º
```

### 6.2 å…·ä½“ä»»åŠ¡æ¸…å•

#### ä»»åŠ¡ 1: é€‰æ‹©å¤š Agent æ¡†æ¶
**æ¨è**: LangGraph (Supervisor + Worker æ¨¡å¼)

**åŸå› **:
- âœ… å®Œå…¨æ§åˆ¶æ¯ä¸ª Agent çš„è¡Œä¸º
- âœ… å›¾ç»“æ„å¤©ç„¶é€‚åˆ Planner â†’ Workers â†’ Coordinator æµç¨‹
- âœ… ä¸ Vanna.AI å…¼å®¹
- âœ… ç”Ÿäº§çº§ç¨³å®šæ€§

**å‚è€ƒ**: é˜¿é‡Œé€šä¹‰ DeepResearch çš„ Planner + Executor åŒæ™ºèƒ½ä½“æ¶æ„

#### ä»»åŠ¡ 2: è®¾è®¡æ•°æ®åº“ Schema
åˆ›å»ºæ–°è¡¨å­˜å‚¨ "è¡¨ç®¡ç†å‘˜" é…ç½®:

```sql
CREATE TABLE table_agents (
  id INT AUTO_INCREMENT PRIMARY KEY,
  table_name VARCHAR(255) NOT NULL,
  agent_config JSON NOT NULL,  -- åŒ…å«å­—æ®µè¯­ä¹‰ã€æŸ¥è¯¢è§„åˆ™ã€CoT æ¨¡æ¿
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

**agent_config JSON ç»“æ„**:
```json
{
  "fields": {
    "æ‰€åœ¨çœ": {
      "type": "category",
      "match": "fuzzy",
      "values": ["å¹¿ä¸œçœ", "åŒ—äº¬å¸‚", ...]
    },
    "æ‰€åœ¨å¸‚": {
      "type": "category",
      "match": "fuzzy",
      "values": ["å¹¿å·å¸‚", "æ·±åœ³å¸‚", ...]
    },
    "æˆç«‹å¹´": {
      "type": "numeric",
      "match": "exact_or_range",
      "range": [1990, 2023]
    },
    "2021æ€»æ”¶å…¥": {
      "type": "numeric",
      "match": "range",
      "unit": "å…ƒ"
    }
  },
  "cot_template": "...",
  "query_examples": [...]
}
```

#### ä»»åŠ¡ 3: å®ç° Meta-Agent
**åŠŸèƒ½**: åˆ†æä¸Šä¼ çš„è¡¨ï¼Œç”Ÿæˆè¡¨ç®¡ç†å‘˜é…ç½®

**è¾“å…¥**: è¡¨å¤´ + å‰ 5 è¡Œæ•°æ®
**è¾“å‡º**: agent_config JSON

**Prompt ç¤ºä¾‹**:
```
ä½ æ˜¯ä¸€ä¸ªæ•°æ®è¡¨åˆ†æä¸“å®¶ã€‚è¯·åˆ†æä»¥ä¸‹è¡¨æ ¼ï¼Œç”Ÿæˆä¸€ä¸ª"è¡¨ç®¡ç†å‘˜ Agent"é…ç½®ã€‚

è¡¨å: institutions
è¡¨å¤´: ['ç»„ç»‡åç§°', 'æ‰€åœ¨çœ', 'æ‰€åœ¨å¸‚', 'æˆç«‹å¹´', '2021æ€»æ”¶å…¥', ...]
æ ·æœ¬æ•°æ®: [
  {'ç»„ç»‡åç§°': 'XXç¯ä¿åä¼š', 'æ‰€åœ¨çœ': 'å¹¿ä¸œçœ', 'æ‰€åœ¨å¸‚': 'å¹¿å·å¸‚', ...},
  ...
]

è¯·ç”Ÿæˆ:
1. å­—æ®µè¯­ä¹‰ç†è§£ (æ¯ä¸ªå­—æ®µçš„å«ä¹‰ã€æ•°æ®ç±»å‹)
2. æŸ¥è¯¢è§„åˆ™ (ç²¾ç¡®åŒ¹é…/æ¨¡ç³ŠåŒ¹é…/èŒƒå›´åŒ¹é…)
3. CoT æ¨¡æ¿ (æ„å›¾è¯†åˆ«å’ŒæŸ¥è¯¢æ‹†è§£é€»è¾‘)
4. æŸ¥è¯¢ç¤ºä¾‹

è¾“å‡ºæ ¼å¼: JSON
```

#### ä»»åŠ¡ 4: ä¿®æ”¹ Excel ä¸Šä¼ æ¥å£
åœ¨ `doris-api/main.py` çš„ `/api/upload/excel` æ¥å£ä¸­:

1. ä¸Šä¼ å®Œæˆåï¼Œæå–è¡¨å¤´å’Œå‰ 5 è¡Œæ•°æ®
2. è°ƒç”¨ Meta-Agent ç”Ÿæˆ agent_config
3. å­˜å‚¨åˆ° `table_agents` è¡¨

#### ä»»åŠ¡ 5: å®ç° Planner Agent
**åŠŸèƒ½**: åˆ†æç”¨æˆ·é—®é¢˜ï¼Œå†³å®šéœ€è¦å“ªäº›è¡¨

**è¾“å…¥**: ç”¨æˆ·é—®é¢˜
**è¾“å‡º**: éœ€è¦çš„è¡¨åˆ—è¡¨ + å­ä»»åŠ¡

**ç¤ºä¾‹**:
```
é—®é¢˜: "2022å¹´å¹¿å·åœ°åŒºæ”¶å…¥è¶…5ä¸‡å…ƒçš„æœºæ„æœ‰å¤šå°‘ä¸ª?"
â†“
Planner åˆ†æ:
- æ¶‰åŠè¡¨: institutions
- å­ä»»åŠ¡: 
  - å¹´ä»½è¿‡æ»¤: æˆç«‹å¹´ = 2022
  - åœ°åŒºè¿‡æ»¤: æ‰€åœ¨å¸‚ LIKE '%å¹¿å·%'
  - æ”¶å…¥è¿‡æ»¤: 2021æ€»æ”¶å…¥ > 50000
```

#### ä»»åŠ¡ 6: å®ç° Table Admin Agent
**åŠŸèƒ½**: ä½¿ç”¨ CoT æ‹†è§£é—®é¢˜ï¼Œç”Ÿæˆç²¾ç¡® SQL

**è¾“å…¥**: å­ä»»åŠ¡ + agent_config
**è¾“å‡º**: SQL

**CoT ç¤ºä¾‹**:
```
å­ä»»åŠ¡: "2022å¹´å¹¿å·åœ°åŒºæ”¶å…¥è¶…5ä¸‡å…ƒ"
â†“
CoT æ‹†è§£:
1. è¯†åˆ«å­—æ®µ: æˆç«‹å¹´, æ‰€åœ¨å¸‚, 2021æ€»æ”¶å…¥
2. ç¡®å®šåŒ¹é…æ–¹å¼:
   - æˆç«‹å¹´: ç²¾ç¡®åŒ¹é… (= 2022)
   - æ‰€åœ¨å¸‚: æ¨¡ç³ŠåŒ¹é… (LIKE '%å¹¿å·%')
   - 2021æ€»æ”¶å…¥: èŒƒå›´åŒ¹é… (> 50000)
3. ç”Ÿæˆ SQL:
   SELECT COUNT(*) FROM institutions 
   WHERE æˆç«‹å¹´ = 2022 
     AND æ‰€åœ¨å¸‚ LIKE '%å¹¿å·%' 
     AND 2021æ€»æ”¶å…¥ > 50000
```

#### ä»»åŠ¡ 7: å®ç° Coordinator Agent
**åŠŸèƒ½**: æ±‡æ€»å¤šä¸ªè¡¨çš„ç»“æœ

**è¾“å…¥**: å„è¡¨ç®¡ç†å‘˜çš„ SQL å’Œç»“æœ
**è¾“å‡º**: æœ€ç»ˆ SQL (å¯èƒ½éœ€è¦ JOIN) å’Œç»“æœ

#### ä»»åŠ¡ 8: ä½¿ç”¨ LangGraph ç¼–æ’
```python
from langgraph.graph import StateGraph

workflow = StateGraph()
workflow.add_node("planner", planner_agent)
workflow.add_node("table_admin_institutions", table_admin_agent)
workflow.add_node("coordinator", coordinator_agent)

workflow.add_edge("planner", "table_admin_institutions")
workflow.add_edge("table_admin_institutions", "coordinator")

app = workflow.compile()
```

#### ä»»åŠ¡ 9: ä¿®æ”¹è‡ªç„¶è¯­è¨€æŸ¥è¯¢æ¥å£
åœ¨ `doris-api/main.py` çš„ `/api/query/natural` æ¥å£ä¸­:

1. ä¸å†ç›´æ¥è°ƒç”¨ Vanna.AI
2. æ”¹ä¸ºè°ƒç”¨ LangGraph workflow
3. è¿”å›æœ€ç»ˆç»“æœ

#### ä»»åŠ¡ 10: æµ‹è¯•å’Œä¼˜åŒ–
1. æµ‹è¯•å•è¡¨æŸ¥è¯¢
2. æµ‹è¯•è·¨è¡¨æŸ¥è¯¢
3. æµ‹è¯•å¤æ‚å¤šç»´åº¦æŸ¥è¯¢
4. ä¼˜åŒ– Prompt
5. ä¼˜åŒ– CoT æ¨¡æ¿

---

## ä¸ƒã€å…³é”®æ–‡ä»¶è¯´æ˜

### 7.1 `doris-api/vanna_doris.py`
**å·²ä¼˜åŒ–çš„ Vanna.AI é›†æˆ**

**å…³é”®æ–¹æ³•**:
- `get_column_sample_values()` - è·å–åˆ—çš„æ ·æœ¬å€¼ (ç”¨äºæ¨¡ç³ŠåŒ¹é…)
- `is_important_column()` - åˆ¤æ–­åˆ—æ˜¯å¦é‡è¦ (åœ°ç†ã€æ—¶é—´ã€è´¢åŠ¡ç­‰)
- `get_sql_prompt()` - ç”Ÿæˆå¢å¼ºçš„ Prompt (åŒ…å«æ ·æœ¬æ•°æ®å’Œæ¨¡ç³ŠåŒ¹é…è§„åˆ™)

**æ³¨æ„**: è¿™ä¸ªæ–‡ä»¶åœ¨å¤š Agent æ¶æ„ä¸­ä»ç„¶æœ‰ç”¨ï¼Œå¯ä»¥ä½œä¸º Table Admin Agent çš„åº•å±‚ SQL ç”Ÿæˆå¼•æ“ã€‚

### 7.2 `doris-api/main.py`
**FastAPI ä¸»ç¨‹åº**

**éœ€è¦ä¿®æ”¹çš„æ¥å£**:
- `/api/upload/excel` - æ·»åŠ  Meta-Agent è°ƒç”¨
- `/api/query/natural` - æ”¹ä¸ºè°ƒç”¨ LangGraph workflow

### 7.3 `docker-compose.yml`
**å®¹å™¨ç¼–æ’é…ç½®**

**ç¯å¢ƒå˜é‡**:
```yaml
- DORIS_DATABASE=doris_db
- DEEPSEEK_API_KEY=sk-748638f482f74b7392a6dafd89bdd307  # éœ€è¦æ›´æ–°
- DEEPSEEK_MODEL=deepseek-chat
- DEEPSEEK_BASE_URL=https://api.deepseek.com
```

---

## å…«ã€é‡è¦æç¤º

### 8.1 DeepSeek API Key
**å½“å‰ Key å¯èƒ½å·²å¤±æ•ˆ**: `sk-748638f482f74b7392a6dafd89bdd307`

**è·å–æ–° Key**:
1. è®¿é—®: https://platform.deepseek.com/
2. æ³¨å†Œ/ç™»å½•
3. åˆ›å»º API Key
4. æ›´æ–° `docker-compose.yml` ä¸­çš„ `DEEPSEEK_API_KEY`

### 8.2 ç”¨æˆ·çš„æ ¸å¿ƒéœ€æ±‚
ç”¨æˆ·éå¸¸æ˜ç¡®åœ°è¦æ±‚:
1. âœ… **ç»™å¤§æ¨¡å‹è¶³å¤Ÿçš„æƒé™** - è®© AI è‡ªå·±åˆ¤æ–­ä½•æ—¶ç”¨ç²¾ç¡®åŒ¹é…ã€ä½•æ—¶ç”¨æ¨¡ç³ŠåŒ¹é…
2. âœ… **å†™å¥½ Prompt** - è¿™æ˜¯å…³é”®
3. âœ… **å¤š Agent æ¶æ„** - Planner + Table Admins + Coordinator
4. âœ… **CoT æ„å›¾è¯†åˆ«** - æ¯ä¸ªè¡¨ç®¡ç†å‘˜éƒ½æœ‰è‡ªå·±çš„æ¨ç†é“¾

### 8.3 å‚è€ƒèµ„æ–™
- **LangGraph æ–‡æ¡£**: https://langchain-ai.github.io/langgraph/
- **é˜¿é‡Œ DeepResearch**: https://github.com/Alibaba-NLP/DeepResearch
- **Vanna.AI æ–‡æ¡£**: https://vanna.ai/docs/

---

## ä¹ã€éƒ¨ç½²å’Œè¿è¡Œ

### 9.1 å¯åŠ¨æœåŠ¡
```bash
cd doris-sga
docker-compose up -d --build
```

### 9.2 è®¿é—®åœ°å€
- **å‰ç«¯**: http://localhost:5173
- **åç«¯ API**: http://localhost:8018
- **Doris FE**: http://localhost:18030

### 9.3 åœæ­¢æœåŠ¡
```bash
docker-compose down
```

---

## åã€Git ä»“åº“

**ä»“åº“åœ°å€**: https://github.com/sga-jerrylin/doris-sga/tree/master

**å½“å‰åˆ†æ”¯**: master

**æœ€è¿‘æäº¤**: "æ™ºèƒ½ Prompt å¢å¼º - è‡ªåŠ¨æ¨¡ç³ŠåŒ¹é…åŸå¸‚åç§° (å¹¿å·â†’å¹¿å·å¸‚)"

---

## åä¸€ã€è”ç³»æ–¹å¼

**ç”¨æˆ·**: sga-jerrylin
**Email**: jerrylin@sologenai.com

---

**äº¤æ¥å®Œæ¯•ï¼ä¸‹ä¸€ä¸ª Agent å¯ä»¥ä»ä»»åŠ¡ 1 å¼€å§‹ï¼Œé€æ­¥å®ç°å¤š Agent æ¶æ„ã€‚ç¥å¥½è¿ï¼** ğŸš€
